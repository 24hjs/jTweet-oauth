(function(a){a.fn.tweet=function(c){c=a.extend({},{screen_name:"the base username",count:5,exclude_replies:!1,include_rts:!0,refresh:1},c);return this.each(function(){var j=a(this),f="",n=new Date,h=null,k=null,l=null,m=null;if(Modernizr.localstorage&&localStorage.tweets&&JSON.parse(localStorage.tweets))if(h=JSON.parse(localStorage.tweets),k=(n.getTime()-h.cachedAt)/1E3/60,k>c.refresh)localStorage.clear(),console.warn("LocalStorage has been cleared");else return j.html(h.text);a.ajax({dataType:"json",
url:"php/requestOAuth.php",data:c}).done(function(c){l=new Date;a.each(c,function(c,a){var g=created_at=new Date(a.created_at),d,e,b,g=(l.getTime()-g.getTime())/1E3;e=g/60;b=e/60;60>g?d="just now":60>e?(e=Math.floor(e),d=1<e?e+" minutes ago":"about a minute ago"):24>b?(b=Math.floor(b),d=1<b?b+" hours ago":"about an hour ago"):24<=b&&(days=Math.floor(b/24),d=1<days?days+" days ago":"about a day ago");timePosted=d;d="";tweetText=d=a.text.toString().replace(/(((https?:\/\/)|(www1?))\S+)/gi,'<a href="$1">$1</a>').replace(/(\#{1}(\w+))/gi,
'<a href="https://www.twitter.com/$1">$1</a>').replace(/(\@{1}(\w+))/gi,'<a href="https://www.twitter.com/$1">$1</a>');f+='<div class="twitter-single-tweet"><div class="twitter-tweet">'+tweetText+'</div><div class="twitter-posted-at">'+timePosted+"</div></div>"});Modernizr.localstorage&&(m=(new Date).getTime(),tweets={text:f,cachedAt:m},localStorage.tweets=JSON.stringify(tweets));j.html(f)}).fail(function(){console.error("There was an error with OAuth, the Twitter service is down, or your php/requestOAuth.php is missing/invalid")})})}})(jQuery);
