(function(){for(var a,b=function(){},c="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd table time timeEnd timeStamp trace warn".split(" "),d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)})(),function(a){function b(a,b){var c,d,e,f,g;return d=a.getTime()-b.getTime(),e=d/1e3,f=e/60,g=f/60,60>e?c="just now":60>f?(f=Math.floor(f),c=f>1?f+" minutes ago":"about a minute ago"):24>g?(g=Math.floor(g),c=g>1?g+" hours ago":"about an hour ago"):g>=24&&(days=Math.floor(g/24),c=days>1?days+" days ago":"about a day ago"),c}function c(a){var b="",c=/(((https?:\/\/)|(www1?))\S+)/gi,d=/(\#{1}(\w+))/gi,e=/(\s\@{1}(\w+))/gi;return b=a.replace(c,'<a href="$1">$1</a>').replace(d,'<a href="https://www.twitter.com/$1">$1</a>').replace(e,'<a href="https://www.twitter.com/$1">$1</a>')}function d(a){var b=a.split(" ");return new Date(Date.parse(b[1]+" "+b[2]+", "+b[5]+" "+b[3]+" UTC"))}a.fn.jTweet=function(e){var f={screen_name:"the base username",count:5,exclude_replies:!1,include_rts:!0,refresh:5,show_profile:!0,css_prefix_class:"jTweet",debug:!1,no_tweets_msg:"There are no tweets available"};return e=a.extend({},f,e),this.each(function(){var f=a(this),g="",h=new Date,i=null,j=null,k=null,l=null;if(Modernizr.localstorage&&localStorage["jTweets-oauth"]&&JSON.parse(localStorage["jTweets-oauth"])){if(i=JSON.parse(localStorage["jTweets-oauth"]),j=(h.getTime()-i.cachedAt)/1e3/60,!(j>e.refresh))return f.html(i.text);localStorage.clear(),console.warn("LocalStorage has been cleared")}a.ajax({dataType:"json",url:"./php/requestOAuth.php",data:e}).done(function(h){return k=new Date,h.errors!==void 0&&h.errors[0].hasOwnProperty("code")?(e.debug&&(console.error("Twitter Error Code ("+h.errors[0].code+"): "+h.errors[0].message),localStorage["jTweets-oauth-error-log"]="Twitter Error Code ("+h.errors[0].code+"): "+h.errors[0].message),f.html(e.no_tweets_msg)):(a.each(h,function(a,f){userImage="",created_at=d(f.created_at),timePosted=b(k,created_at),tweetText=c(""+f.text),e.show_profile&&""!==f.user.profile_image_url&&(userImage='<img src="'+f.user.profile_image_url+'" alt="'+f.user.screen_name+": "+f.user.description+"/>"),g+='<div class="'+e.css_prefix_class+'-single-tweet">'+userImage+'<div class="'+e.css_prefix_class+'-tweet-text">'+tweetText+'<div class="'+e.css_prefix_class+'-posted-at">'+timePosted+"</div></div></div>"}),Modernizr.localstorage&&(l=(new Date).getTime(),tweets={text:g,cachedAt:l},localStorage["jTweets-oauth"]=JSON.stringify(tweets)),f.html(g),void 0)}).fail(function(a){console.error("There was an error with OAuth, the Twitter service is down, or php/requestOAuth.php is missing/invalid"),e.debug&&console.error(a)})})}}(jQuery);
